LAMMPS (29 Aug 2024 - Development - patch_4Feb2020-21274-g90b616edd6-modified)


# ----------------- Init Section -----------------

include "02_cg_slab_01.in.init"
# Input variables
variable run    string 02_cg_slab_01
variable ts     equal  20.          # timestep
variable tf     equal  300.         # Equilibrium temperature
variable cutoff equal  14.          # For interactions in real space
variable skin   equal  4.           # Skin distance for neighbour list
variable s      equal  5            # sample interval for averaging
variable cl     equal  200          # correlation length for averaging
variable prod   equal  50000        # Equilibration steps (1 ns)


# Force field setup.
boundary        p p p
units           real
atom_style hybrid molecular ellipsoid
WARNING: Atom style hybrid defines both, per-type and per-atom masses; both must be set, but only per-atom masses will be used (../atom_vec_hybrid.cpp:132)
bond_style ellipsoid
special_bonds lj/coul 0.0 0.2 0.5
# gamma upsilon mu lj_cutoff coul_cutoff
pair_style molc/cut 1 1 -3 ${cutoff} ${cutoff}
pair_style molc/cut 1 1 -3 14 ${cutoff}
pair_style molc/cut 1 1 -3 14 14

# Neighbour list.
neighbor        ${skin} bin
neighbor        4 bin


# ----------------- Atom Definition Section -----------------

read_data "02_cg_slab_01.data"
Reading data file ...
  orthogonal box = (-74.9454 -72.0258 -36.5586) to (74.9454 72.0258 186.559)
  4 by 2 by 4 MPI processor grid
  reading atoms ...
  17280 atoms
  17280 ellipsoids
  reading velocities ...
  17280 velocities
  scanning bonds ...
  1 = max bonds/atom
  orthogonal box = (-74.9454 -72.0258 -36.5586) to (74.9454 72.0258 186.559)
  4 by 2 by 4 MPI processor grid
  reading bonds ...
  16920 bonds
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0.2      0.5     
  special bond factors coul:  0        0.2      0.5     
     2 = max # of 1-2 neighbors
     2 = max # of 1-3 neighbors
     4 = max # of 1-4 neighbors
     6 = max # of special neighbors
  special bonds CPU = 0.009 seconds
  read_data CPU = 0.222 seconds

# ----------------- Settings Section -----------------

include "02_cg_slab_01.in.settings"
mass 1 72.0634

# MOLC parameters.
pair_coeff 1 1 1.0627 3.4740 0.97313 1 0.36835 4 1.931251    0.539650    1.011545    0.0668 0.446082    0.057700   -0.000000    0.6529 -0.712230    1.072980    0.000000   -0.4227 -0.653529   -1.140853    0.000000   -0.2970
mass 2  58.0366

# MOLC parameters.
pair_coeff 2 2 1.0116 3.3432 0.53249 0.53249 1 3 -0.422955   -1.245763    0.000000   -0.313 0.527142    0.083536    0.000000    0.716 -0.856806    0.981621    0.000000   -0.403

# 1-2 Bonded potential.
bond_coeff 1 poly 2 0   -0.90854   -3.67091    21.0619    3.46926  cos  2 0   0.468392     1.5682    0.77494          0  cos  2 0   0.051231    1.55637   0.368657          0  cos  2 0   -0.63579    1.57002   -0.40024          0  cos  1 0  -0.291573       1.57  cos  2 0 -0.0454135    1.56739  -0.159876          0  cos  2 0  0.0689315    1.56411   0.326725          0  cos  2 0 -0.0380405    1.56469  -0.222524          0  cos  1 0   0.214176    1.57072  cos  2 0    0.06476      1.555   0.672605          0  poly 2 0    0.63728    2.15358     35.456   0.284144  cos  1 0    1.06641     4.7121  poly 0 0  poly 2 0    1.09113    2.29165    13.2812    1.04108  poly 2 0    1.29123    1.05776    4.62779   0.409837  poly 2 0    1.71005    1.02317    12.3945 -0.0340389



# ----------------- Run Section -----------------

include "02_cg_slab_01.in.run"
# Physical observables.
compute q               all property/atom quatw quati quatj quatk
compute diameter        all property/atom shapex shapey shapez
compute temp_trasl      all temp
compute temp_rototrasl  all temp/asphere dof all
compute press_trasl     all pressure temp_trasl

# Derived variables.
variable d       equal ${cl}*$s          # thermo interval
variable d       equal 200*$s          
variable d       equal 200*5          
variable dcycle  equal ${prod}/$s        # dump interval
variable dcycle  equal 50000/$s        
variable dcycle  equal 50000/5        

# Output.
thermo          $d
thermo          1000
thermo_style custom step etotal evdwl ecoul ebond ke pe temp press cpu
thermo_modify temp temp_rototrasl press press_trasl flush yes

# Save the trajectory.
dump TRJ all custom ${dcycle} ${run}.dump id type xu yu zu c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3] vx vy vz angmomx angmomy angmomz mol
dump TRJ all custom 10000 ${run}.dump id type xu yu zu c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3] vx vy vz angmomx angmomy angmomz mol
dump TRJ all custom 10000 02_cg_slab_01.dump id type xu yu zu c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3] vx vy vz angmomx angmomy angmomz mol
dump_modify TRJ colname c_q[1] quatw colname c_q[2] quati colname c_q[3] quatj colname c_q[4] quatk sort id

# Remove any drift from the starting configuration.
velocity all zero linear

# Equilibration of the slab in the vacuum.
timestep        ${ts}
timestep        20
fix             NVE all nve/asphere
fix             TEMP all langevin ${tf} ${tf} $(dt*100) 35785 angmom 0.9
fix             TEMP all langevin 300 ${tf} $(dt*100) 35785 angmom 0.9
fix             TEMP all langevin 300 300 $(dt*100) 35785 angmom 0.9
fix             TEMP all langevin 300 300 2000 35785 angmom 0.9
fix_modify      TEMP temp temp_rototrasl
run    ${prod}
run    50000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- USER-MOLC package:

Article{C9CP04120F,
  author = {Ricci, Matteo and Roscioni, Otello Maria and Querciagrossa, Lara and Zannoni, Claudio},
  title  = {MOLC. A reversible coarse grained approach using anisotropic beads for the modelling of organic functional materials},
  journal  = {Phys. Chem. Chem. Phys.},
  year  = 2019,
  volume = 21,
  issue  = 47,
  pages  = {26195-26211},
  publisher = {The Royal Society of Chemistry},
  doi  = {10.1039/C9CP04120F},
  url  = {http://dx.doi.org/10.1039/C9CP04120F},
  abstract  = {We describe the development and implementation of a coarse grained (CG) modelling approach where complex organic molecules, and particularly the \pi-conjugated ones often employed in organic electronics, are modelled in terms of connected sets of attractive--repulsive biaxial Gay--Berne ellipsoidal beads. The CG model is aimed at reproducing realistically large scale morphologies (e.g. up to 100 nm thick films) for the materials involved, while being able to generate, with a back-mapping procedure, atomistic coordinates suitable, with limited effort, to be applied for charge transport calculations. Detailed methodology and an application to the common hole transporter material \alpha-NPD are provided.}
}

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282--3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 18
  ghost atom cutoff = 18
  binsize = 9, bins = 17 17 25
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair molc/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 7.97 | 8.505 | 9.055 Mbytes
   Step         TotEng         E_vdwl         E_coul         E_bond         KinEng         PotEng          Temp          Press           CPU      
         0  -228904.92     -47682.013     -17334.295     -194961.11      31072.496     -259977.42      301.63427      205.62899      0            
      1000  -230990.31     -49451.346     -18047.408     -195217.2       31725.639     -262715.95      307.97461     -82.865278      142.02427    
      2000  -236047.15     -50403.324     -22103.618     -195155.79      31615.582     -267662.73      306.90624     -94.910758      287.46259    
      3000  -233913.96     -50758.695     -19563.934     -195024.47      31433.137     -265347.09      305.13516     -66.019618      437.11563    
      4000  -233397.07     -51144.244     -18545.881     -195050.27      31343.323     -264740.4       304.2633      -82.937373      584.24565    
      5000  -243945.21     -51377.386     -28894.845     -194996.51      31323.531     -275268.74      304.07117     -132.46921      737.51871    
      6000  -236572.59     -51505.5       -21012.351     -195278.82      31224.077     -267796.67      303.10573     -100.27554      888.50881    
      7000  -234494.04     -51596.848     -19178.985     -195182.84      31464.629     -265958.67      305.44087     -76.843457      1039.7082    
      8000  -241690.71     -51817.269     -26021.442     -195235.06      31383.061     -273073.77      304.64905     -112.69973      1190.8181    
      9000  -242726.4      -51788.169     -27216.22      -194931.74      31209.736     -273936.13      302.96651     -87.865693      1341.7094    
     10000  -234318.49     -51954.137     -18337.497     -195217.59      31190.734     -265509.22      302.78205     -58.137652      1492.0925    
     11000  -235330.24     -51838.911     -19842.843     -195113.59      31465.095     -266795.34      305.44539     -92.724499      1644.0233    
     12000  -238773.84     -51962.051     -23098.551     -194960.24      31247.002     -270020.84      303.32827     -107.1573       1794.1937    
     13000  -239261.51     -51992.081     -23652.412     -195074.85      31457.832     -270719.34      305.37489     -98.514024      1949.5402    
     14000  -236264.63     -51945.54      -20393.586     -195152.85      31227.342     -267491.97      303.13742     -92.701905      2104.0195    
     15000  -228460.97     -52029.888     -12738.696     -195101.69      31409.298     -259870.27      304.90375     -28.36483       2260.6796    
     16000  -236556.52     -52064.418     -20907.832     -194896.12      31311.851     -267868.37      303.95778     -66.678441      2423.612     
     17000  -240596.95     -52237.078     -24847.017     -194967.54      31454.681     -272051.63      305.3443      -115.05558      2586.2623    
     18000  -247546.6      -52215.107     -31046.924     -195371.04      31086.473     -278633.07      301.76994     -141.70006      2743.3693    
     19000  -231179.27     -52453.098     -15003.525     -195015.06      31292.42      -262471.69      303.76916     -92.736407      2903.9754    
     20000  -240115.95     -52359.956     -23512.66      -195445.73      31202.399     -271318.35      302.89529     -110.49832      3062.0523    
     21000  -234027.28     -52304.764     -17768.126     -195223.22      31268.826     -265296.11      303.54012     -47.010051      3221.534     
     22000  -243283.37     -52298.534     -27052.523     -195085.5       31153.188     -274436.56      302.41757     -110.92574      3379.9483    
     23000  -236581.22     -52378.084     -20188.635     -195292.44      31277.941     -267859.16      303.6286      -80.822261      3538.4965    
     24000  -235672.67     -52369.729     -19611.649     -195145.49      31454.193     -267126.86      305.33956     -91.625012      3696.4243    
     25000  -237233.53     -52402.326     -21089.002     -195063.44      31321.235     -268554.76      304.04888     -59.126524      3856.4839    
     26000  -237378.8      -52385.313     -21040.909     -195306.13      31353.559     -268732.36      304.36266     -82.858002      4015.2862    
     27000  -240218.5      -52406.259     -23674.163     -195089.13      30951.053     -271169.55      300.45536     -86.78577       4175.1468    
     28000  -235505.49     -52382.257     -19578.457     -195093.2       31548.417     -267053.91      306.25423     -98.2521        4337.0281    
     29000  -237092.9      -52389.146     -20811.064     -195187.31      31294.618     -268387.52      303.7905      -99.960708      4498.3219    
     30000  -238298.02     -52505.372     -21586.164     -195477.81      31271.322     -269569.34      303.56435     -73.422014      4656.8575    
     31000  -242433.24     -52461.927     -25741.404     -195401.3       31171.397     -273604.63      302.59434     -85.942922      4816.7183    
     32000  -236249.38     -52566.347     -19711.571     -195230.85      31259.39      -267508.77      303.44852     -71.324436      4980.0731    
     33000  -239804.51     -52407.159     -23391.835     -195464.29      31458.779     -271263.29      305.38408     -78.17969       5137.8262    
     34000  -239918.92     -52493.215     -23577.099     -195259.41      31410.803     -271329.72      304.91835     -94.353782      5298.2189    
     35000  -239093.2      -52499.558     -22719.817     -195376.95      31503.128     -270596.33      305.8146      -70.217412      5460.1625    
     36000  -242431.96     -52637.298     -25966.462     -195182.84      31354.639     -273786.6       304.37315     -119.9488       5620.1132    
     37000  -241310.73     -52490.901     -24591.531     -195310.25      31081.954     -272392.68      301.72607     -92.280139      5778.8643    
     38000  -236165.79     -52515.455     -19684.838     -195261.66      31296.166     -267461.95      303.80552     -55.674058      5939.7541    
     39000  -243484.94     -52719.161     -26950.348     -195323.71      31508.28      -274993.22      305.86461     -99.98731       6098.1045    
     40000  -241936.56     -52748.603     -25591.665     -194985.3       31389.004     -273325.57      304.70675     -95.338737      6254.2707    
     41000  -236590.47     -52614.837     -20330.864     -195094.33      31449.567     -268040.04      305.29466     -83.712218      6410.8963    
     42000  -238944.98     -52516.652     -21869.172     -195536.9       30977.735     -269922.72      300.71438     -37.105459      6564.7802    
     43000  -234014.89     -52736.348     -17385.616     -195281.64      31388.718     -265403.61      304.70397     -55.980854      6723.2165    
     44000  -238770.06     -52602.795     -22196.895     -195237.59      31267.222     -270037.28      303.52455     -72.640095      6877.2552    
     45000  -234831.19     -52696.91      -18529.01      -195152.37      31547.104     -266378.29      306.24149     -57.106278      7035.9295    
     46000  -242011.97     -52737.369     -25121.012     -195291.17      31137.587     -273149.55      302.26613     -89.918046      7190.7015    
     47000  -241418.33     -52584.487     -24665.895     -195197.46      31029.513     -272447.85      301.21701     -72.141718      7348.6398    
     48000  -238144.52     -52669.809     -21646.857     -195270.71      31442.851     -269587.37      305.22946     -63.451268      7504.4768    
     49000  -237973.73     -52569.743     -21428.833     -195190.61      31215.448     -269189.18      303.02196     -80.714129      7659.9125    
     50000  -242843.48     -52707.371     -26193.477     -195370.25      31427.623     -274271.1       305.08164     -108.18858      7814.8996    
Loop time of 7814.91 on 32 procs for 50000 steps with 17280 atoms

Performance: 11.056 ns/day, 2.171 hours/ns, 6.398 timesteps/s, 110.558 katom-step/s
98.4% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.034852   | 2191.3     | 6885.8     |5733.4 | 28.04
Bond    | 0.032057   | 78.808     | 243.46     |1007.5 |  1.01
Neigh   | 23.202     | 25.051     | 28.667     |  41.4 |  0.32
Comm    | 9.9816     | 3499.2     | 7603.2     |5322.7 | 44.78
Output  | 0.40528    | 2.5064     | 8.6918     | 225.3 |  0.03
Modify  | 0.12687    | 9.2104     | 26.639     | 339.2 |  0.12
Other   |            | 2009       |            |       | 25.71

Nlocal:            540 ave        1586 max           0 min
Histogram: 16 0 0 8 0 0 0 0 0 8
Nghost:        2184.78 ave        4672 max           0 min
Histogram: 8 0 0 8 0 8 0 0 0 8
Neighs:        61423.6 ave      188524 max           0 min
Histogram: 16 0 0 8 0 0 0 0 0 8

Total # of neighbors = 1965554
Ave neighs/atom = 113.74734
Ave special neighs/atom = 5.75
Neighbor list builds = 2662
Dangerous builds = 0
Total wall time: 2:10:15
