LAMMPS (29 Aug 2024 - Development - patch_4Feb2020-21274-g90b616edd6-modified)


# ----------------- Init Section -----------------

include "04_cg_sample_01.in.init"
# Input variables
variable run    string 04_cg_sample_01
variable ts     equal  20.          # timestep
variable tf     equal  300.         # Equilibrium temperature
variable pf     equal  1.           # Equilibrium pressure
variable cutoff equal  14.          # For interactions in real space
variable skin   equal  4.           # Skin distance for neighbour list
variable s      equal  5            # sample interval for averaging
variable cl     equal  200          # correlation length for averaging
variable prod   equal  100000       # Equilibration steps (2 ns)


# Force field setup.
boundary        p p p
units           real
atom_style hybrid molecular ellipsoid
WARNING: Atom style hybrid defines both, per-type and per-atom masses; both must be set, but only per-atom masses will be used (../atom_vec_hybrid.cpp:132)
bond_style ellipsoid
special_bonds lj/coul 0.0 0.2 0.5
# gamma upsilon mu lj_cutoff coul_cutoff
pair_style molc/long 1 1 -3 ${cutoff} ${cutoff}
pair_style molc/long 1 1 -3 14 ${cutoff}
pair_style molc/long 1 1 -3 14 14

# Neighbour list.
neighbor        ${skin} bin
neighbor        4 bin


# ----------------- Atom Definition Section -----------------

read_data "04_cg_sample_01.data"
Reading data file ...
  orthogonal box = (-74.9454 -72.0258 -36.5586) to (74.9454 72.0258 186.559)
  4 by 2 by 4 MPI processor grid
  reading atoms ...
  98282 atoms
  98282 ellipsoids
  reading velocities ...
  98282 velocities
  scanning bonds ...
  1 = max bonds/atom
  orthogonal box = (-74.9454 -72.0258 -36.5586) to (74.9454 72.0258 186.559)
  4 by 2 by 4 MPI processor grid
  reading bonds ...
  16920 bonds
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0.2      0.5     
  special bond factors coul:  0        0.2      0.5     
     2 = max # of 1-2 neighbors
     2 = max # of 1-3 neighbors
     4 = max # of 1-4 neighbors
     6 = max # of special neighbors
  special bonds CPU = 0.012 seconds
  read_data CPU = 0.869 seconds

# ----------------- Settings Section -----------------

include "04_cg_sample_01.in.settings"
mass 1 72.0634

# MOLC parameters.
pair_coeff 1 1 1.0627 3.4740 0.97313 1 0.36835 4 1.931251    0.539650    1.011545    0.0668 0.446082    0.057700   -0.000000    0.6529 -0.712230    1.072980    0.000000   -0.4227 -0.653529   -1.140853    0.000000   -0.2970
mass 2  58.0366

# MOLC parameters.
pair_coeff 2 2 1.0116 3.3432 0.53249 0.53249 1 3 -0.422955   -1.245763    0.000000   -0.313 0.527142    0.083536    0.000000    0.716 -0.856806    0.981621    0.000000   -0.403

# 1-2 Bonded potential.
bond_coeff 1 poly 2 0   -0.90854   -3.67091    21.0619    3.46926  cos  2 0   0.468392     1.5682    0.77494          0  cos  2 0   0.051231    1.55637   0.368657          0  cos  2 0   -0.63579    1.57002   -0.40024          0  cos  1 0  -0.291573       1.57  cos  2 0 -0.0454135    1.56739  -0.159876          0  cos  2 0  0.0689315    1.56411   0.326725          0  cos  2 0 -0.0380405    1.56469  -0.222524          0  cos  1 0   0.214176    1.57072  cos  2 0    0.06476      1.555   0.672605          0  poly 2 0    0.63728    2.15358     35.456   0.284144  cos  1 0    1.06641     4.7121  poly 0 0  poly 2 0    1.09113    2.29165    13.2812    1.04108  poly 2 0    1.29123    1.05776    4.62779   0.409837  poly 2 0    1.71005    1.02317    12.3945 -0.0340389

mass 3  40.4364

# MOLC parameters.
# epsilon0, sigma0, eps_x, eps_y, eps_z, n_charges, (xi, yi, zi, qi)_ntimes
pair_coeff 3 3 0.18519 3.1589 1 1 1 3 0.00000  0.154600  0.0  -1.1128 0.75695  0.585882  0.0   0.5564 -0.75695  0.585882  0.0   0.5564

# Force field setup.
kspace_style pppm/molc 1e-4


# ----------------- Run Section -----------------

include "04_cg_sample_01.in.run"
# Physical observables.
compute q               all property/atom quatw quati quatj quatk
compute diameter        all property/atom shapex shapey shapez
compute temp_trasl      all temp
compute temp_rototrasl  all temp/asphere dof all
compute press_trasl     all pressure temp_trasl

# Derived variables.
variable d       equal ${cl}*$s          # thermo interval
variable d       equal 200*$s          
variable d       equal 200*5          
variable dcycle  equal ${prod}/$s        # dump interval
variable dcycle  equal 100000/$s        
variable dcycle  equal 100000/5        

# Output.
thermo          $d
thermo          1000
thermo_style custom step etotal evdwl ecoul elong ebond ke pe temp press pxx pyy pzz vol density cpu
thermo_modify temp temp_rototrasl
thermo_modify press press_trasl
thermo_modify flush yes

# Save the trajectory.
dump TRJ all custom ${dcycle} ${run}.dump id type xu yu zu c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3] vx vy vz angmomx angmomy angmomz mol
dump TRJ all custom 20000 ${run}.dump id type xu yu zu c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3] vx vy vz angmomx angmomy angmomz mol
dump TRJ all custom 20000 04_cg_sample_01.dump id type xu yu zu c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3] vx vy vz angmomx angmomy angmomz mol
dump_modify TRJ colname c_q[1] quatw colname c_q[2] quati colname c_q[3] quatj colname c_q[4] quatk sort id

# Remove bad contacts from the initial guess.
minimize 0.01 0.01 100 200

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- USER-MOLC package:

Article{C9CP04120F,
  author = {Ricci, Matteo and Roscioni, Otello Maria and Querciagrossa, Lara and Zannoni, Claudio},
  title  = {MOLC. A reversible coarse grained approach using anisotropic beads for the modelling of organic functional materials},
  journal  = {Phys. Chem. Chem. Phys.},
  year  = 2019,
  volume = 21,
  issue  = 47,
  pages  = {26195-26211},
  publisher = {The Royal Society of Chemistry},
  doi  = {10.1039/C9CP04120F},
  url  = {http://dx.doi.org/10.1039/C9CP04120F},
  abstract  = {We describe the development and implementation of a coarse grained (CG) modelling approach where complex organic molecules, and particularly the \pi-conjugated ones often employed in organic electronics, are modelled in terms of connected sets of attractive--repulsive biaxial Gay--Berne ellipsoidal beads. The CG model is aimed at reproducing realistically large scale morphologies (e.g. up to 100 nm thick films) for the materials involved, while being able to generate, with a back-mapping procedure, atomistic coordinates suitable, with limited effort, to be applied for charge transport calculations. Detailed methodology and an application to the common hole transporter material \alpha-NPD are provided.}
}

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282--3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

PPPM/MOlC initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:342)
  G vector (1/distance) = 0.18623151
  grid = 54 54 75
  stencil order = 5
  estimated absolute RMS force accuracy = 0.03747114
  estimated relative force accuracy = 0.00011284322
  using double precision KISS FFT
  3d grid and FFT values/proc = 90829 0
Generated 3 of 3 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 18
  ghost atom cutoff = 18
  binsize = 9, bins = 17 17 25
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair molc/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.29 | 19.19 | 30.19 Mbytes
   Step         TotEng         E_vdwl         E_coul         E_long         E_bond         KinEng         PotEng          Temp          Press           Pxx            Pyy            Pzz           Volume        Density          CPU      
         0   4.0381783e+10  4.038285e+10   4578503.7     -5673378.8     -195370.34      222600.62      4.038156e+10   379.91838      2.2991627e+09  6.8964649e+09  327085.87      696174.08      4817557.4      1.5373246      0            
